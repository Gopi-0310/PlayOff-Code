<app-top-nav></app-top-nav>
<div class="top-nav-space"></div> <!--needed for top-nav-->
<div class="container-fluid">
    <mat-accordion>
        <mat-expansion-panel [expanded]="expand_accordion">
            <mat-expansion-panel-header class="purple-color-bg">
                <mat-panel-title class="white-color f-1_2">
                    Registered Users
                </mat-panel-title>
            </mat-expansion-panel-header>
            <div>
                <!-- Angular Table -->
                <!-- Paginator & Filter \\\ -->
                <div class="row mt-3 mb-1" >
                    <div class="col-6">
                    <mat-form-field class="text-start">
                        <mat-label>Filter</mat-label>
                        <input matInput (keyup)="users_Filter($event)" placeholder="Ex. John Doe" #input>
                    </mat-form-field>
                    </div>
                    <div  class="col-6">
                    <mat-paginator #usersPage [pageSizeOptions]="[5,10, 25, 100]" aria-label="Select page of users"></mat-paginator>
                    </div>
                </div>
                <!-- Paginator & Filter /// -->
                <div class="mat-elevation-z8  hide_scrollbar mh-50vh">
                    <table mat-table #usersSort="matSort" [dataSource]="users_data" matSort >
                        <!-- Identifier -->
                        <ng-container matColumnDef="identifier">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header style="width:24% !important"> Identifier</th>
                            <td mat-cell *matCellDef="let row" class="text-start" style="width:24% !important"
                            [class]="row.identifier == crypto.Logged_User ? 'purple-color font-bold' : ''"> 
                            {{row.identifier}} <span *ngIf="row.identifier == crypto.Logged_User">(You)</span></td>
                        </ng-container>
                        <!-- Additional Factor -->
                        <ng-container matColumnDef="additionalFactor">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header  style="width:32% !important"> Additional Factor </th>
                            <td mat-cell *matCellDef="let row" class="text-start " style="width:32% !important"> 
                                <span *ngIf="row.additionalFactor != null"
                                [class]="row.identifier == crypto.Logged_User ? 'purple-color font-bold' : ''">{{row.additionalFactor}}</span>
                                <span *ngIf="row.additionalFactor == null"
                                [class]="row.identifier == crypto.Logged_User ? 'purple-color font-bold' : ''">NA</span>
                            </td>
                        </ng-container>
                        <!-- Role -->
                        <ng-container matColumnDef="role">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header  style="width:22% !important"> Role </th>
                            <td mat-cell *matCellDef="let row" class="text-start box-container" style="width:22% !important"
                            [class]="row.identifier == crypto.Logged_User ? 'purple-color font-bold' : ''"> {{row.role}}
                                <div class="small-box" [ngClass]="{'bg-professional': row.role === 'Professional', 'bg-advanced': row.role === 'Advanced', 'bg-basic': row.role === 'Basic'}">
                                    <!-- Role indicator -->
                                </div>
                            </td>
                        </ng-container>
                        <!-- Promote Access -->
                        <ng-container matColumnDef="promote">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header class="w-2" style="width:8% !important"> Promote </th>
                            <td mat-cell *matCellDef="let row" class="text-start" style="width:8% !important">
                                <button mat-raised-button color="primary" type="button" (click)="Promote(row)"[disabled]="row.identifier == crypto.Logged_User || row.role == 'Professional'">
                                    <i class="fas fa-sort-amount-up-alt fa-1x"></i>
                                </button>
                            </td>
                        </ng-container>
                        <!-- Demote Access -->
                        <ng-container matColumnDef="demote">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header class="w-2" style="width:8% !important"> Demote </th>
                            <td mat-cell *matCellDef="let row" class="text-start "style="width:8% !important">
                                <button mat-raised-button color="primary" type="button" (click)="Demote(row)" [disabled]="row.identifier == crypto.Logged_User || row.role == 'Basic'">
                                    <i class="fas fa-sort-amount-down-alt fa-1x"></i>
                                </button>
                            </td>
                        </ng-container>
                        <!-- Delete Btn -->
                        <ng-container matColumnDef="delete">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header style="width:6% !important"> Delete </th>
                            <td mat-cell *matCellDef="let row" class="text-start" style="width:6% !important">
                            <button mat-raised-button color="primary" type="button" (click)="openDialog(row, 'delete')" [disabled]="row.identifier == crypto.Logged_User">
                                <i class="far fa-trash-alt fa-1x"></i>
                            </button>
                            </td>
                        </ng-container>
                        <tr mat-header-row *matHeaderRowDef="users_columns"></tr>
                        <tr mat-row *matRowDef="let row; columns: users_columns;"></tr>
                        <!-- Row shown when there is no matching data. -->
                        <tr class="mat-row" *matNoDataRow>
                            <td class="mat-cell" colspan="4" class="ps-4">No data matching the filter "{{input.value}}"</td>
                        </tr> 
                        </table>
                    </div>
            </div>
        </mat-expansion-panel>
    </mat-accordion>
    <!-- Angular Expansion Panel /// -->
</div>
